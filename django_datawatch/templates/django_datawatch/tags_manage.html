{% extends "django_datawatch/base.html" %}
{% load i18n %}
{% load django_bootstrap5 %}

{% block django_datawatch %}
<div class="container mt-2 mb-4">
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <div>
                <strong>{% trans "Manage tags for" %}</strong>
                {{ result.get_check_instance.get_title }}
            </div>
        </div>
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-md-12">
                    <h5>{% trans "Existing tags" %}</h5>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>{% trans "Type" %}</th>
                                <th>{% trans "Tag" %}</th>
                                <th>{% trans "Created by" %}</th>
                                <th>{% trans "Created at" %}</th>
                                <th>{% trans "Actions" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for tag in tags %}
                                <tr>
                                    <td><span class="badge {{ tag.badge_class }}">{{ tag.get_type_display }}&nbsp;</span></td>
                                    <td>{{ tag.tag }}</td>
                                    <td>{{ tag.user }}</td>
                                    <td>{{ tag.created|date:"SHORT_DATETIME_FORMAT" }}</td>
                                    <td>
                                        <a href="{% url 'django_datawatch_result_tag_edit' result_pk=result.pk tag_pk=tag.pk %}" class="btn btn-sm btn-link">{% trans "Edit" %}</a>
                                        <form method="post" action="{% url 'django_datawatch_result_tag_delete' result_pk=result.pk tag_pk=tag.pk %}" style="display:inline">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-sm btn-danger">{% trans "Delete" %}</button>
                                        </form>
                                    </td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="6">{% trans "No tags yet." %}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <div class="mt-3">
                        <a href="{% url 'django_datawatch_result_tag_add' result_pk=result.pk %}" class="btn btn-primary">{% trans "Add tag" %}</a>
                        <a href="{% url 'django_datawatch_result' pk=result.pk %}" class="btn btn-link">{% trans "Cancel" %}</a>
                    </div>
                 </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
